(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{150:function(t,e,s){"use strict";s.r(e);var a=s(0),n=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),s("p",[s("a",{attrs:{href:"https://travis-ci.org/slanatech/vue-monorepo-boilerplate",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://travis-ci.org/slanatech/vue-monorepo-boilerplate.svg?branch=master",alt:"Build Status"}}),s("OutboundLink")],1)]),t._m(1),t._m(2),t._m(3),s("p",[t._v("This boilerplate uses "),s("a",{attrs:{href:"https://lernajs.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Lerna"),s("OutboundLink")],1),t._v(" and "),s("a",{attrs:{href:"https://yarnpkg.com/lang/en/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Yarn"),s("OutboundLink")],1),t._v(" workspaces to manage packages in monorepo.\n"),s("a",{attrs:{href:"https://cli.vuejs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-cli"),s("OutboundLink")],1),t._v(" is used in UI package. Suggest to install "),s("a",{attrs:{href:"https://lernajs.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Lerna"),s("OutboundLink")],1),t._v(", "),s("a",{attrs:{href:"https://yarnpkg.com/en/docs/install",target:"_blank",rel:"noopener noreferrer"}},[t._v("Yarn"),s("OutboundLink")],1),t._v(" and "),s("a",{attrs:{href:"https://cli.vuejs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-cli"),s("OutboundLink")],1),t._v(" globally in dev environment")]),t._m(4),t._m(5),t._m(6),t._m(7),t._m(8),t._m(9),t._m(10),t._m(11),t._m(12),t._m(13),t._m(14),t._m(15),t._m(16),s("p",[t._v("For illustration, in this boilerplate common package is made public, and other packages are private.")]),t._m(17),t._m(18),t._m(19),s("p",[t._v("Docker build context is top level directory, so all app packages can be accessed.")]),s("p",[t._v("Docker image entrypoint script just starts server, and you may access UI at "),s("a",{attrs:{href:"http://localhost:3200",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:3200"),s("OutboundLink")],1)]),s("p",[t._v("See "),s("code",[t._v("Dockefile")]),s("a",{attrs:{href:"https://github.com/slanatech/vue-monorepo-boilerplate/blob/master/docker/Dockerfile",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/slanatech/vue-monorepo-boilerplate/blob/master/docker/Dockerfile"),s("OutboundLink")],1)]),s("p",[t._v("Dockerfile is set up with two goals in mind:")]),t._m(20),s("p",[t._v("These layers with 3rd party modules will be cached on Docker image rebuild if only app code changes:")]),t._m(21),s("p",[t._v("And this copies app code - only relevant content from local packages - to Docker image.\nThese layers will be rebuilt when app code changes:")]),t._m(22),t._m(23),t._m(24),t._m(25),t._m(26),t._m(27),s("p",[t._v("CI/CD is set up using Travis CI")]),s("p",[t._v("See "),s("code",[t._v(".travis.yml")]),s("a",{attrs:{href:"https://github.com/slanatech/vue-monorepo-boilerplate/blob/master/.travis.yml",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/slanatech/vue-monorepo-boilerplate/blob/master/.travis.yml"),s("OutboundLink")],1)]),t._m(28),t._m(29),t._m(30),t._m(31),t._m(32),t._m(33),s("p",[t._v("If you find a bug, or have an enhancement in mind please post "),s("a",{attrs:{href:"https://github.com/slanatech/vue-monorepo-boilerplate/issues",target:"_blank",rel:"noopener noreferrer"}},[t._v("issues"),s("OutboundLink")],1),t._v(" on GitHub.\nSuggestions and feedback are very welcome !")]),t._m(34),s("p",[t._v("MIT")])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"vue-monorepo-boilerplate"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vue-monorepo-boilerplate","aria-hidden":"true"}},[this._v("#")]),this._v(" vue-monorepo-boilerplate")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"vue-fullstack-app-monorepo-boilerplate"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vue-fullstack-app-monorepo-boilerplate","aria-hidden":"true"}},[this._v("#")]),this._v(" Vue Fullstack App Monorepo Boilerplate")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[t._v("Lerna and Yarn Workspaces to manage monorepo")]),s("li",[t._v("Full Stack: Front End, Server, Common module packages")]),s("li",[t._v("Front End package: Vue SPA using Vue-cli 3")]),s("li",[t._v("Server package: Node+Express")]),s("li",[t._v("Common package: common code used in both Front End and Server")]),s("li",[t._v("Docs using Vuepress and Github pages")]),s("li",[t._v("CI/CD using Travis CI")]),s("li",[t._v("Docker build")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"prerequisites"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites","aria-hidden":"true"}},[this._v("#")]),this._v(" Prerequisites")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"quick-start"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quick-start","aria-hidden":"true"}},[this._v("#")]),this._v(" Quick start")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("# 1. Clone the repository.")]),t._v("\n"),s("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/slanatech/vue-monorepo-boilerplate.git my-new-project\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("# 2. Enter your newly-cloned folder")]),t._v("\n"),s("span",{attrs:{class:"token function"}},[t._v("cd")]),t._v(" my-new-project\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("# 3. Bootstrap")]),t._v("\nyarn run bootstrap\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("# 4. Run Build in all packages ")]),t._v("\nyarn run build\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("# 5. Dev: Run Server and in parallel start UI Serve with hot reload ")]),t._v("\nyarn run dev\n\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"top-level-scripts"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#top-level-scripts","aria-hidden":"true"}},[this._v("#")]),this._v(" Top-Level Scripts")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[t._v("  "),s("span",{attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"bootstrap"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"lerna bootstrap"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"dev"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"concurrently --kill-others --success first \\"npm start --prefix ./packages/server\\" \\"npm run serve --prefix ./packages/ui\\""')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"test"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"npm run test:common && npm run test:server && npm run test:ui"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"test:common"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"npm test --prefix ./packages/common"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"test:server"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"npm test --prefix ./packages/server"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"test:ui"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"npm test --prefix ./packages/ui"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"build"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"lerna run build"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"docs:dev"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"vuepress dev docs"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"docs:build"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"vuepress build docs"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"docs:deploy"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"yarn run docs:build && ./scripts/docsdeploy.sh"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"docker:build"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"IMAGE_VERSION=$(node -p \\"require(\'./lerna.json\').version\\") && docker image build -t $npm_package_config_imageRepo:$IMAGE_VERSION -f ./docker/Dockerfile ."')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v('"publish"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"lerna publish"')]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("code",[t._v("bootstrap")]),t._v(" - install all packages and setup links for internal packages using lerna")]),s("li",[s("code",[t._v("dev")]),t._v(" - run Server and in parallel start UI Serve with hot reload")]),s("li",[s("code",[t._v("test")]),t._v(" - execute tests in all packages")]),s("li",[s("code",[t._v("test:common")]),t._v(" -  execute tests in common package")]),s("li",[s("code",[t._v("test:server")]),t._v(" -  execute tests in server package")]),s("li",[s("code",[t._v("test:ui")]),t._v(" -  execute tests in UI package")]),s("li",[s("code",[t._v("build")]),t._v(" -  execute build script in all packages")]),s("li",[s("code",[t._v("docs:dev")]),t._v(" - vuepress documentation development")]),s("li",[s("code",[t._v("docs:build")]),t._v(" -  build vuepress docs")]),s("li",[s("code",[t._v("docs:deploy")]),t._v(" - deploy vuepress docs to github pages")]),s("li",[s("code",[t._v("docker:build")]),t._v(" - build Docker image")]),s("li",[s("code",[t._v("publish")]),t._v(" - publish public packages using lerna")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"dev"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dev","aria-hidden":"true"}},[this._v("#")]),this._v(" Dev")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Top-level script "),e("code",[this._v("yarn run dev")]),this._v(" starts Server package that contains back end API implementation.\nAnd in parallel starts "),e("code",[this._v("vue-cli-service serve")]),this._v(" script in UI package.\nThis allows UI development with hot reloading, with dev server proxying API requests to API implementation")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("vue.config.js")]),this._v(" in UI package is configured to proxy API requests:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("// vue.config.js")]),t._v("\nmodule"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  devServer"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    proxy"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'http://localhost:3200'")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"publishing-packages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#publishing-packages","aria-hidden":"true"}},[this._v("#")]),this._v(" Publishing packages")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("yarn run publish\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("This will publish all public packages in monorepo to npm by invoking "),e("code",[this._v("lerna publish")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Depending on your needs, you may choose to keep some or all packages private by setting "),e("code",[this._v('"private": true')]),this._v(" in package.json of packages in monorepo.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"docker-build"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-build","aria-hidden":"true"}},[this._v("#")]),this._v(" Docker Build")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Top-level script "),e("code",[this._v("yarn run docker:build")]),this._v(" builds Docker image that contains entire Full Stack app:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("UI package - compiled UI static files ("),e("code",[this._v("/dist")]),this._v(")")]),e("li",[this._v("Common module package")]),e("li",[this._v("Server package that implements API and serves UI static files")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Utilize layers cache with minimal rebuild when app code changes")]),e("li",[this._v("Don't publish all packages to npm on every build")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-dockerfile extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("RUN yarn global add lerna\n\nCOPY package.json lerna.json yarn.lock /app/\nCOPY packages/common/package.json /app/packages/common/package.json\nCOPY packages/server/package.json /app/packages/server/package.json\nCOPY packages/ui/package.json /app/packages/ui/package.json\n\nRUN yarn install --production=true\n\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-dockerfile extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("# Application Packages\nADD packages/common/lib /app/packages/common/lib/\nCOPY packages/server/server.js /app/packages/server/server.js\nADD packages/ui/dist /app/packages/ui/dist/\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Finally, "),e("code",[this._v("bootstrap")]),this._v(" to ensure proper symlinks to local packages are set up in "),e("code",[this._v("node_modules")]),this._v(":")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-dockerfile extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("RUN yarn run bootstrap\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Example of "),e("code",[this._v("docker run")]),this._v(":")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{attrs:{class:"token comment"}},[this._v("#!/usr/bin/env bash")]),this._v("\n\ndocker run -d -p 3200:3200 --name app --restart always slanatech/vue-monorepo-boilerplate:0.1.8\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"ci-cd"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ci-cd","aria-hidden":"true"}},[this._v("#")]),this._v(" CI/CD")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("before_install")]),this._v(" executes "),e("code",[this._v("bootstrap")]),this._v(" to ensure local packages are resolved:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{attrs:{class:"token key atrule"}},[this._v("before_install")]),e("span",{attrs:{class:"token punctuation"}},[this._v(":")]),this._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[this._v("-")]),this._v(" yarn && yarn run bootstrap\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Then build script just executes "),e("code",[this._v("build")]),this._v(","),e("code",[this._v("test")]),this._v(", and "),e("code",[this._v("docker:build")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{attrs:{class:"token key atrule"}},[t._v("script")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" yarn run build\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" yarn run test\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" yarn run docker"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("build\n\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("If desired, you may extend "),e("code",[this._v(".travis.yml")]),this._v(" adding publishing packages to npm, and publishing docker image to Docker registry.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"enhancements-and-bug-reports"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#enhancements-and-bug-reports","aria-hidden":"true"}},[this._v("#")]),this._v(" Enhancements and Bug Reports")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"license"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#license","aria-hidden":"true"}},[this._v("#")]),this._v(" License")])}],!1,null,null,null);e.default=n.exports}}]);